{% extends 'base.html.twig' %}

{% block title %} Détail d'une sortie {% endblock %}

{% block body %}
    {% for type, messages in app.flashes %}
        {% for message in messages %}
            <div class="alert alert-{{ type }}" role="alert">
                {{ message }}
            </div>
        {% endfor %}
    {% endfor %}
    <div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
        {% if (event.status.id == 6) %}
            <h1>LA SORTIE {{ event.name }} EST ANNULEE</h1>
        {% endif %}
        {% if (event.status.id < 6) %}
            <h1 class="display-4">Sortie {{ event.name }} </h1>
        {% endif %}

        <div class="row">
            <div class="col-4 p-3">

                <p class="lead text-left"><b>Durée de l'évènement:</b> {{ event.duration }}</p>
                <p class="lead text-left"><b>Date de début: </b>{{ event.startingDateTime |date("m/d/Y") }}</p>
                <p class="lead text-left"><b>Date Limite
                        d'inscription:</b> {{ event.inscriptionDeadLine |date("m/d/Y") }}</p>
                <p class="lead text-left"><b>Nombre maximum d'inscrit:</b> {{ event.nbMaxRegistration }}</p>

                <p class="lead text-left"><b>Description de la sortie: </b>{{ event.eventDetails }}</p>
                <p class="lead text-left"><b>Nombre de participant: </b>{{ event.registeredMembers|length }}</p>


            </div>
            <div class="col-4">
                <p class="lead text-left"><b>Lieu : </b>{{ event.location.name }}</p>
                <p class="lead text-left"><b>Ville : </b> {{ event.location.city.name  }}</p>
                <p class="lead text-left"><b>Rue : </b> {{ event.location.street  }}</p>
                <p class="lead text-left"><b>Code Postal : </b> {{ event.location.city.zipCode  }}</p>
            </div>

        <div class="col-4">
            <h3>Liste des participants</h3>
        <table id="tableParticipants" class="col-3 table table-striped table-bordered">
            <thead class="thead-dark">
            <tr>
                <th scope="col">Pseudo</th>
                <th scope="col">Nom</th>
            </tr>
            </thead>
            <tbody>
            {% if event.registeredMembers is not empty %}
                {% for p in event.registeredMembers %}
                    <tr class="">
                        <td class="row"><a
                                    href="{{ path('event-details',{'id': p.id}) }}"> {{ p.username }}</a>
                        </td>
                    </tr>
                {% else %}
                    <li><em>no user found</em></li>
                {% endfor %}
            {% endif %}
            </tbody>
        </table>
        </div>
    </div>
    <div class="relative">
    {% if(event.registeredMembers| length < event.nbMaxRegistration) and app.user not in event.registeredMembers and event.inscriptionDeadLine  > date() %}
        {% if (event.status.id == 2) %}
            <a class="btn btn-lg btn-info" href="{{ path('inscriptionEvent', {"id": event.id }) }}">S'inscrire</a>
        {% endif %}
    {% endif %}

    {% if (event.status.id == 2 ) %}
        {% if(app.user in event.registeredMembers) %}
            <a class="btn btn-lg btn-info" href="{{ path('deinscriptionEvent', {"id": event.id }) }}">Se
                désinscrire</a>
        {% endif %}
    {% endif %}

    {% if (event.status.id == 2 ) %}
        {% if (app.user == event.organizer) %}
            <a class="btn btn-lg btn-outline-danger" href="{{ path('event-details', {"id": event.id }) }}">Annuler</a>
            {% if(event.status.id == 1) %}
                <a class="btn btn-lg btn-outline-info"
                   href="{{ path('event-details', {"id": sortie.id }) }}">Modifier</a>
            {% endif %}
        {% endif %}
    {% endif %}
    </div>

{% endblock %}